cmake_minimum_required(VERSION 3.27.0)
set(CMAKE_CXX_STANDARD 20)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)

project(wLog)

file(GLOB_RECURSE SRC src/*.cpp)

add_library(wLog STATIC ${SRC})
target_include_directories(wLog PUBLIC include)

if(NOT CMAKE_INSTALL_PREFIX)
    set(CMAKE_INSTALL_PREFIX ${CMAKE_CURRENT_SOURCE_DIR}/install)
endif()
set(CMAKE_INSTALL_LIBDIR ${CMAKE_INSTALL_PREFIX}/lib)
set(CMAKE_INSTALL_INCLUDEDIR ${CMAKE_INSTALL_PREFIX}/include)

install(TARGETS wLog
    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR})

install(DIRECTORY include/ 
    DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}
    FILES_MATCHING PATTERN "*.h")

configure_file(cmake/FindwLog.cmake.in FindwLog.cmake @ONLY)

install(FILES ${CMAKE_CURRENT_BINARY_DIR}/FindwLog.cmake
        DESTINATION ${CMAKE_INSTALL_LIBDIR}/cmake/wLog)